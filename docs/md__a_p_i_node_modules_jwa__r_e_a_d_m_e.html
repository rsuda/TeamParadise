<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Team Paradise: node-jwa &lt;a href=&quot;https://travis-ci.org/brianloveswords/node-jwa&quot;&gt;&lt;img src=&quot;https://travis-ci.org/brianloveswords/node-jwa.svg?branch=master&quot; alt=&quot;Build Status&quot;/&gt;&lt;/a&gt;</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Team Paradise
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">node-jwa <a href="https://travis-ci.org/brianloveswords/node-jwa"><img src="https://travis-ci.org/brianloveswords/node-jwa.svg?branch=master" alt="Build Status" style="pointer-events: none;" class="inline"/></a> </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>A <a href="http://tools.ietf.org/id/draft-ietf-jose-json-web-algorithms-08.html">JSON Web Algorithms</a> implementation focusing (exclusively, at this point) on the algorithms necessary for <a href="http://self-issued.info/docs/draft-ietf-jose-json-web-signature.html">JSON Web Signatures</a>.</p>
<p>This library supports all of the required, recommended and optional cryptographic algorithms for JWS:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">alg Parameter Value  </th><th class="markdownTableHeadNone">Digital Signature or MAC Algorithm   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">HS256  </td><td class="markdownTableBodyNone">HMAC using SHA-256 hash algorithm   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">HS384  </td><td class="markdownTableBodyNone">HMAC using SHA-384 hash algorithm   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">HS512  </td><td class="markdownTableBodyNone">HMAC using SHA-512 hash algorithm   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">RS256  </td><td class="markdownTableBodyNone">RSASSA using SHA-256 hash algorithm   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">RS384  </td><td class="markdownTableBodyNone">RSASSA using SHA-384 hash algorithm   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">RS512  </td><td class="markdownTableBodyNone">RSASSA using SHA-512 hash algorithm   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PS256  </td><td class="markdownTableBodyNone">RSASSA-PSS using SHA-256 hash algorithm   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">PS384  </td><td class="markdownTableBodyNone">RSASSA-PSS using SHA-384 hash algorithm   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PS512  </td><td class="markdownTableBodyNone">RSASSA-PSS using SHA-512 hash algorithm   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">ES256  </td><td class="markdownTableBodyNone">ECDSA using P-256 curve and SHA-256 hash algorithm   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">ES384  </td><td class="markdownTableBodyNone">ECDSA using P-384 curve and SHA-384 hash algorithm   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">ES512  </td><td class="markdownTableBodyNone">ECDSA using P-521 curve and SHA-512 hash algorithm   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">none  </td><td class="markdownTableBodyNone">No digital signature or MAC value included   </td></tr>
</table>
<p>Please note that PS* only works on Node 6.12+ (excluding 7.x).</p>
<h1><a class="anchor" id="autotoc_md1116"></a>
Requirements</h1>
<p>In order to run the tests, a recent version of OpenSSL is required. <b>The version that comes with OS X (OpenSSL 0.9.8r 8 Feb 2011) is not recent enough</b>, as it does not fully support ECDSA keys. You'll need to use a version &gt; 1.0.0; I tested with OpenSSL 1.0.1c 10 May 2012.</p>
<h1><a class="anchor" id="autotoc_md1117"></a>
Testing</h1>
<p>To run the tests, do</p>
<div class="fragment"><div class="line">$ npm test</div>
</div><!-- fragment --><p>This will generate a bunch of keypairs to use in testing. If you want to generate new keypairs, do <code>make clean</code> before running <code>npm test</code> again.</p>
<h2><a class="anchor" id="autotoc_md1118"></a>
Methodology</h2>
<p>I spawn <code>openssl dgst -sign</code> to test OpenSSL sign → JS verify and <code>openssl dgst -verify</code> to test JS sign → OpenSSL verify for each of the RSA and ECDSA algorithms.</p>
<h1><a class="anchor" id="autotoc_md1119"></a>
Usage</h1>
<h2><a class="anchor" id="autotoc_md1120"></a>
jwa(algorithm)</h2>
<p>Creates a new <code>jwa</code> object with <code>sign</code> and <code>verify</code> methods for the algorithm. Valid values for algorithm can be found in the table above (&lsquo;'HS256&rsquo;<code>,</code>'HS384'<code>, etc) and are case-insensitive. Passing an invalid algorithm value will throw a</code>TypeError`.</p>
<h2><a class="anchor" id="autotoc_md1121"></a>
jwa#sign(input, secretOrPrivateKey)</h2>
<p>Sign some input with either a secret for HMAC algorithms, or a private key for RSA and ECDSA algorithms.</p>
<p>If input is not already a string or buffer, <code>JSON.stringify</code> will be called on it to attempt to coerce it.</p>
<p>For the HMAC algorithm, <code>secretOrPrivateKey</code> should be a string or a buffer. For ECDSA and RSA, the value should be a string representing a PEM encoded <b>private</b> key.</p>
<p>Output <a href="http://en.wikipedia.org/wiki/Base64#URL_applications">base64url</a> formatted. This is for convenience as JWS expects the signature in this format. If your application needs the output in a different format, <a href="https://github.com/brianloveswords/node-jwa/issues">please open an issue</a>. In the meantime, you can use <a href="https://github.com/brianloveswords/base64url">brianloveswords/base64url</a> to decode the signature.</p>
<p>As of nodejs <em>v0.11.8</em>, SPKAC support was introduce. If your nodeJs version satisfies, then you can pass an object &lsquo;{ key: &rsquo;..', passphrase: '...' }`</p>
<h2><a class="anchor" id="autotoc_md1122"></a>
jwa#verify(input, signature, secretOrPublicKey)</h2>
<p>Verify a signature. Returns <code>true</code> or <code>false</code>.</p>
<p><code>signature</code> should be a base64url encoded string.</p>
<p>For the HMAC algorithm, <code>secretOrPublicKey</code> should be a string or a buffer. For ECDSA and RSA, the value should be a string represented a PEM encoded <b>public</b> key.</p>
<h1><a class="anchor" id="autotoc_md1123"></a>
Example</h1>
<p>HMAC </p><div class="fragment"><div class="line">const jwa = require(&#39;jwa&#39;);</div>
<div class="line"> </div>
<div class="line">const hmac = jwa(&#39;HS256&#39;);</div>
<div class="line">const input = &#39;super important stuff&#39;;</div>
<div class="line">const secret = &#39;shhhhhh&#39;;</div>
<div class="line"> </div>
<div class="line">const signature = hmac.sign(input, secret);</div>
<div class="line">hmac.verify(input, signature, secret) // === true</div>
<div class="line">hmac.verify(input, signature, &#39;trickery!&#39;) // === false</div>
</div><!-- fragment --><p>With keys </p><div class="fragment"><div class="line">const fs = require(&#39;fs&#39;);</div>
<div class="line">const jwa = require(&#39;jwa&#39;);</div>
<div class="line">const privateKey = fs.readFileSync(__dirname + &#39;/ecdsa-p521-private.pem&#39;);</div>
<div class="line">const publicKey = fs.readFileSync(__dirname + &#39;/ecdsa-p521-public.pem&#39;);</div>
<div class="line"> </div>
<div class="line">const ecdsa = jwa(&#39;ES512&#39;);</div>
<div class="line">const input = &#39;very important stuff&#39;;</div>
<div class="line"> </div>
<div class="line">const signature = ecdsa.sign(input, privateKey);</div>
<div class="line">ecdsa.verify(input, signature, publicKey) // === true</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md1124"></a>
License</h2>
<p>MIT</p>
<div class="fragment"><div class="line">Copyright (c) 2013 Brian J. Brennan</div>
<div class="line"> </div>
<div class="line">Permission is hereby granted, free of charge, to any person obtaining a</div>
<div class="line">copy of this software and associated documentation files (the</div>
<div class="line">&quot;Software&quot;), to deal in the Software without restriction, including</div>
<div class="line">without limitation the rights to use, copy, modify, merge, publish,</div>
<div class="line">distribute, sublicense, and/or sell copies of the Software, and to</div>
<div class="line">permit persons to whom the Software is furnished to do so, subject to</div>
<div class="line">the following conditions:</div>
<div class="line"> </div>
<div class="line">The above copyright notice and this permission notice shall be included</div>
<div class="line">in all copies or substantial portions of the Software.</div>
<div class="line"> </div>
<div class="line">THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS</div>
<div class="line">OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF</div>
<div class="line">MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND</div>
<div class="line">NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE</div>
<div class="line">LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION</div>
<div class="line">OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION</div>
<div class="line">WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
